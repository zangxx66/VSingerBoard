import{y as e,n as a,o as l}from"./vendor-element-plus-BNN58Tgt.js";import{_ as s,a as t}from"./fans-medal-BtFGd3rB.js";import{v as m}from"./vendor-vue-D3OeNkI5.js";import{p as n}from"./tool-7CWFlNCe.js";import{n as o,r,U as d,q as u,D as i,t as v,L as c,x as f,K as p,ao as y,u as g,y as _,I as k,J as h,G as j,Y as b}from"./vendor-libs-DLrArELd.js";import{b as x}from"./route-block-B_A1xBdJ.js";import"./request-BRje5s3q.js";import"./vendor-exceljs-C-8i3j8b.js";const L={class:"danmaku-sing"},T={class:"danmaku-uname"},H={class:"danmaku-fans"},M=o({name:"danmaku",__name:"index",setup(o){document.title="点歌列表";const x=r(Array()),M=r();m("ws://127.0.0.1:8080",{autoReconnect:!0,autoClose:!0,heartbeat:{message:'{"type":"echo","data":"heartbeat"}',interval:5e3,pongTimeout:1e4},onMessage:(e,a)=>{const l=JSON.parse(a.data),s=q[l.type];s&&s(l.data)}});const q={echo:()=>{},clear:()=>{x.value=[]},remove:e=>{x.value=x.value.filter(a=>a.msg_id!=e)},del:e=>{x.value=x.value.filter(a=>!e.some(e=>e.msg_id===a.msg_id))},add:e=>{x.value=[...x.value,...n(e)]}};return d(x,async()=>{await b(),M.value&&M.value.scrollTo({behavior:"smooth",top:M.value.$el.scrollHeight})}),(m,n)=>{const o=l,r=s,d=t,b=a,q=e;return v(),u(q,{class:"danmaku-container"},{default:i(()=>[c(b,{ref_key:"infiniteList",ref:M,class:"danmaku-list"},{default:i(()=>[(v(!0),f(p,null,y(g(x),(e,a)=>(v(),f("div",{key:a,class:"danmaku-list-item"},[_("div",L,[null!=e.html&&e.html.length>0?(v(),u(o,{key:0,style:{display:"flex"},innerHTML:e.html},null,8,["innerHTML"])):(v(),f(p,{key:1},[k(h(e.msg),1)],64))]),_("div",T,h(e.uname),1),_("div",H,[e.medal_level>0?(v(),f(p,{key:0},["bilibili"==e.source?(v(),u(r,{key:0,"medal-name":e.medal_name,"medal-level":e.medal_level,"guard-level":e.guard_level},null,8,["medal-name","medal-level","guard-level"])):j("",!0),"douyin"==e.source?(v(),u(d,{key:1,"medal-name":e.medal_name,"medal-level":e.medal_level,"guard-level":e.guard_level},null,8,["medal-name","medal-level","guard-level"])):j("",!0)],64)):j("",!0)])]))),128))]),_:1},512)]),_:1})}}});"function"==typeof x&&x(M);export{M as default};
