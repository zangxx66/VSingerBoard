import{m as e,g as a,b as l,c as n,f as t,i,p as o,M as s,N as d,O as r,o as u,E as c,v as m,P as f,Q as p,R as _,C as v,H as g,K as h,L as y,a as w,S as b,u as k,z as x,F as V,G as S,l as F,T as U,U as j,y as q}from"./vendor-element-plus-HZbGYrKl.js";import{_ as C,a as T}from"./fans-medal-DxOaCeZc.js";import{_ as D}from"./line-header.vue_vue_type_script_setup_true_lang-Be3zGABY.js";import{c as E}from"./tool-uNj5llJ9.js";import{n as K,a1 as B,r as z,V as L,x as I,t as O,K as R,L as H,q as M,D as A,y as G,u as N,I as W,a as J,ao as P,J as Q,G as $,H as X,bd as Y,ai as Z,U as ee,E as ae,bb as le}from"./vendor-libs-7289s0cb.js";import{u as ne}from"./theme-Bpk-E46z.js";import{u as te,t as ie}from"./dark-CHiul9fV.js";import{e as oe,f as se,h as de,j as re,u as ue,k as ce,l as me,m as fe,r as pe,n as _e,o as ve}from"./request-BsWu63JD.js";import{u as ge}from"./danmaku-CRfawzi8.js";import{b as he}from"./route-block-B_A1xBdJ.js";import"./vendor-vue-Cl2YAQzn.js";import"./vendor-exceljs-C-8i3j8b.js";const ye={class:"card-header"},we={class:"obs-container"},be={class:"obs-splitter mt-[1rem]",'"':""},ke={class:"css-editor"},xe={class:"css-editor-preview"},Ve={class:"danmaku-container"},Se={class:"danmaku-list"},Fe={class:"danmaku-sing"},Ue=["innerHTML"],je={class:"danmaku-uname"},qe={class:"danmaku-fans"},Ce=K({__name:"obs-setting",setup(m){const f=B({url:`${window.location.origin}/danmaku`}),p=z("/* 弹幕列表CSS */\n.danmaku-container {\n    height: 600px;\n    width: 800px;\n    background: transparent;\n    overflow: hidden;\n}\n.danmaku-list {\n  padding: 0;\n  margin-left: 1%;\n  list-style: none;\n  overflow-y: auto;\n}\n.danmaku-list-item {\n    width: 450px;\n    display: flex;\n    align-items: center;\n    height: 50px;\n    text-align: left;\n    color: #000;\n    font-size: 16px;\n    font-weight: bold;\n    overflow: hidden;\n}\n.danmaku-source-img {\n    margin: 1px;\n    height: 24px;\n}\n.danmaku-sing {\n    width: 200px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n\n.danmaku-uname {\n  width: 180px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  margin-left: 1rem;\n}\n\n.danmaku-fans {\n  width: 200px;\n  margin: 0 auto;\n}\n\n.fans-club-img {\n  margin-left: 10px;\n}\n\n.fans-club-member-img {\n  margin-left: 10px;\n}\n\n.fans-medal-container {\n  margin-left: 10px;\n}\n\n.fans-club-container {\n  width: fit-content;\n  display: flex;\n  align-items: center;\n  margin-right: 1%;\n}\n\n.fans-club-name-container {\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n  border-radius: 15px;\n  width: fit-content;\n  margin-left: 10px;\n}\n\n.fans-club-name-bg {\n  display: block;\n  height: 20px;\n}\n\n.fans-club-name {\n  color: #fff;\n  font-weight: 500;\n  width: 100%;\n  margin-left: -12%;\n}\n/* 弹幕列表CSS END */"),_=z(Array()),v=()=>{E(f.url),c.success("拷贝成功")};return L(()=>{(()=>{for(let e=0;e<10;e++){const a=e%2==0?"bilibili":"douyin",l="bilibili"==a?0:e%3==0?1:2;_.value.push({msg_id:e,uid:e,msg:"点歌弹幕",uname:"username",medal_level:e,medal_name:"粉丝团",guard_level:l,source:a,send_time:Date.now()})}})()}),(c,m)=>{const g=D,h=i,y=t,w=n,b=l,k=a,x=s,V=r,S=u,F=C,U=T,j=d,q=e;return O(),I(R,null,[H(q,null,{header:A(()=>[G("div",ye,[H(g,{class:"flex items-center",title:"OBS设置"})])]),default:A(()=>[G("div",we,[H(k,{model:N(f),"label-width":"auto"},{default:A(()=>[H(b,{label:"OBS地址",prop:"url"},{default:A(()=>[H(w,{modelValue:N(f).url,"onUpdate:modelValue":m[0]||(m[0]=e=>N(f).url=e),type:"text",disabled:""},{append:A(()=>[H(y,{type:"primary",onClick:v},{default:A(()=>[H(h,null,{default:A(()=>[H(N(o))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),H(b,null,{default:A(()=>[H(y,{type:"primary",onClick:v},{default:A(()=>[...m[2]||(m[2]=[W(" 复制地址 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),H(x,{title:"在OBS新建一个浏览器源，在地址栏输入上面复制的地址，即可实现与观众同步点歌板信息，如需使用自定义css样式，请到下方编辑，然后复制到OBS浏览器源中",closable:!1,type:"primary"}),G("div",be,[H(j,null,{default:A(()=>[H(V,{resizable:!1},{default:A(()=>[G("div",ke,[H(g,{title:"样式编辑器"}),H(w,{modelValue:N(p),"onUpdate:modelValue":m[1]||(m[1]=e=>J(p)?p.value=e:null),rows:20,type:"textarea",placeholder:"css样式在这里编辑"},null,8,["modelValue"])])]),_:1}),H(V,{resizable:!1},{default:A(()=>[G("div",xe,[H(g,{title:"样式预览"}),G("div",Ve,[G("div",Se,[(O(!0),I(R,null,P(N(_),(e,a)=>(O(),I("div",{key:a,class:"danmaku-list-item"},[G("div",Fe,[null!=e.html&&e.html.length>0?(O(),M(S,{key:0,class:"flex"},{default:A(()=>[G("span",{innerHTML:e.html},null,8,Ue)]),_:2},1024)):(O(),I(R,{key:1},[W(Q(e.msg),1)],64))]),G("div",je,Q(e.uname),1),G("div",qe,[e.medal_level>0?(O(),I(R,{key:0},["bilibili"==e.source?(O(),M(F,{key:0,"medal-name":e.medal_name,"medal-level":e.medal_level,"guard-level":e.guard_level},null,8,["medal-name","medal-level","guard-level"])):$("",!0),"douyin"==e.source?(O(),M(U,{key:1,"medal-name":e.medal_name,"medal-level":e.medal_level,"guard-level":e.guard_level},null,8,["medal-name","medal-level","guard-level"])):$("",!0)],64)):$("",!0)])]))),128))])])])]),_:1})]),_:1})])])]),_:1}),(O(),M(X("style"),null,{default:A(()=>[W(Q(N(p)),1)]),_:1}))],64)}}}),Te={class:"card-header"},De=K({__name:"app-setting-tab",setup(n){const i=z(),o=z(!1),s=ne(),d=B({id:0,dark_mode:!1,check_update:!1,startup:!1,notification:!1,navSideTour:!1,collapse:!1}),{data:r,isFetching:u}=te(),g=Y({mutationFn:async e=>await oe({data:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"请求失败"):(d.id=e.data,c.success(e.msg||"保存成功"),ie(d.dark_mode),s.setDarkTheme(d.dark_mode)),o.value=!1},onError:e=>{c.error(e.message)}});return Z(()=>{const e=s.getDarkTheme();d.dark_mode=e}),ee(u,()=>{r&&r.value&&(d.id=r.value.id,d.check_update=r.value.check_update,d.collapse=r.value.collapse,d.dark_mode=r.value.dark_mode,d.navSideTour=r.value.navSideTour,d.notification=r.value.notification,d.startup=r.value.startup)}),(n,s)=>{const r=D,c=f,h=l,y=t,w=a,b=e,k=v,x=Ce,V=m;return O(),I(R,null,[H(b,null,{header:A(()=>[G("div",Te,[H(r,{class:"flex items-center",title:"基础设置"})])]),default:A(()=>[ae((O(),M(w,{ref_key:"refForm",ref:i,model:N(d),"label-width":"auto",inline:""},{default:A(()=>[H(h,{label:"黑暗模式",prop:"dark_mode"},{default:A(()=>[H(c,{modelValue:N(d).dark_mode,"onUpdate:modelValue":s[0]||(s[0]=e=>N(d).dark_mode=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":N(_),"inactive-icon":N(p)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),H(h,{label:"桌面通知",prop:"notification"},{default:A(()=>[H(c,{modelValue:N(d).notification,"onUpdate:modelValue":s[1]||(s[1]=e=>N(d).notification=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":N(_),"inactive-icon":N(p)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),H(h,{label:"自动检查更新",prop:"check_update"},{default:A(()=>[H(c,{modelValue:N(d).check_update,"onUpdate:modelValue":s[2]||(s[2]=e=>N(d).check_update=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":N(_),"inactive-icon":N(p)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),H(h,{label:"开机启动",prop:"startup"},{default:A(()=>[H(c,{modelValue:N(d).startup,"onUpdate:modelValue":s[3]||(s[3]=e=>N(d).startup=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":N(_),"inactive-icon":N(p)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),H(h,null,{default:A(()=>[ae((O(),M(y,{type:"primary",onClick:s[4]||(s[4]=e=>(o.value=!0,void g.mutate(d)))},{default:A(()=>[...s[5]||(s[5]=[W("保存",-1)])]),_:1})),[[V,N(o)]])]),_:1})]),_:1},8,["model"])),[[V,N(u)]])]),_:1}),H(k),H(x)],64)}}}),Ee={class:"card-header"},Ke=K({__name:"dy-tab",setup(i){const o=z(),s=z(!1),d=B({id:0,room_id:0,sing_prefix:"点歌",sing_cd:0,fans_level:1}),r=ge(),{data:u,refetch:f,isFetching:p}=le({queryKey:[se.name],queryFn:async()=>{const e=await se({});return 0!=e.code?(c.warning(e.msg||"请求失败"),{id:0,room_id:0,sing_prefix:"点歌",sing_cd:0,fans_level:1}):e.data.data}}),_=Y({mutationFn:async e=>await de({data:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"请求失败"):(c.success("操作成功"),f(),r.clearDanmakuList("douyin"),s.value=!1)},onError:e=>{c.error(e.message)}}),v=()=>{"number"!=typeof d.room_id||d.room_id<1?c.warning("请输入正确的房间号"):0!=d.sing_prefix.length?"number"!=typeof d.sing_cd||d.sing_cd<0?c.warning("请输入正确的点歌cd"):"number"!=typeof d.fans_level||d.fans_level<0?c.warning("请输入正确的粉团等级"):(s.value=!0,_.mutate(d)):c.warning("请输入正确的点歌指令")};return ee(p,()=>{u&&u.value&&(d.id=u.value.id,d.room_id=u.value.room_id,d.sing_prefix=u.value.sing_prefix,d.sing_cd=u.value.sing_cd,d.fans_level=u.value.fans_level)}),(i,r)=>{const u=D,c=g,f=l,_=n,h=t,y=a,w=e,b=m;return O(),M(w,null,{header:A(()=>[G("div",Ee,[H(u,{class:"flex items-center",title:"基础设置"})])]),default:A(()=>[ae((O(),M(y,{ref_key:"refForm",ref:o,mode:N(d),"label-width":"auto"},{default:A(()=>[H(f,{label:"房间号",prop:"room_id"},{default:A(()=>[H(c,{modelValue:N(d).room_id,"onUpdate:modelValue":r[0]||(r[0]=e=>N(d).room_id=e),min:1,controls:!1},null,8,["modelValue"])]),_:1}),H(f,{label:"点歌指令",prop:"sing_prefix"},{default:A(()=>[H(_,{modelValue:N(d).sing_prefix,"onUpdate:modelValue":r[1]||(r[1]=e=>N(d).sing_prefix=e),type:"text",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),H(f,{label:"点歌cd",prop:"sing_cd"},{default:A(()=>[H(c,{modelValue:N(d).sing_cd,"onUpdate:modelValue":r[2]||(r[2]=e=>N(d).sing_cd=e),placeholder:"点歌cd，单位：秒",min:0,controls:!1},null,8,["modelValue"])]),_:1}),H(f,{label:"粉团等级",prop:"fans_level"},{default:A(()=>[H(c,{modelValue:N(d).fans_level,"onUpdate:modelValue":r[3]||(r[3]=e=>N(d).fans_level=e),min:0,controls:!1},null,8,["modelValue"])]),_:1}),H(f,null,{default:A(()=>[ae((O(),M(h,{type:"primary",onClick:v},{default:A(()=>[...r[4]||(r[4]=[W("保存",-1)])]),_:1})),[[b,N(s)]])]),_:1})]),_:1},8,["mode"])),[[b,N(p)]])]),_:1})}}}),Be={class:"b-credential-card-header"},ze={class:"mb-4 flex items-center"},Le={style:{height:"300px","padding-top":"1rem"}},Ie={class:"qcode-image-container"},Oe=["src"],Re={key:0,class:"qcode-bage"},He=K({__name:"bili-credential",setup(a){const l=z(!1),n=z(!1),i=z(0),o=z(""),d=z(""),r=z(Array()),p=[{key:"uid",dataKey:"uid",title:"uid",width:200,cellRenderer:({cellData:e})=>H(u,null,{default:()=>[e,W(" ")]})},{key:"uname",dataKey:"uname",title:"昵称",width:300,cellRenderer:({cellData:e})=>H(u,null,{default:()=>[e,W(" ")]})},{key:"enable",dataKey:"enable",title:"是否启用",width:150,cellRenderer:({rowData:e})=>H(f,{modelValue:e.enable,"inline-prompt":!0,style:"--el-switch-off-color: #ff4949; --el-switch-on-color: #13ce66",activeText:"启用",inactiveText:"禁用",onChange:a=>{V.mutate({id:e.id,enable:a})}},{default:()=>[" "]})},{key:"operations",title:"操作",width:200,maxWidth:1020,minWidth:100,cellRenderer:({rowData:e})=>H(R,null,[H(t,{type:"success",icon:b,loading:n.value,onClick:a=>C(e.id)},{default:()=>[W("刷新凭证")]}),H(t,{type:"danger",icon:k,onClick:a=>q(e.id)},{default:()=>[W("删除")]})])}],{data:_,refetch:v,isFetching:g}=le({queryKey:[re.name],queryFn:async()=>{const e=await re({});return 0!=e.code?(c.warning(e.msg||"请求失败"),[]):e.data.rows},staleTime:1e4}),V=Y({mutationFn:async e=>await ue({data:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"设置失败"):v()},onError:e=>{c.error(e.message)}}),S=Y({mutationFn:async()=>await ce({}),onSuccess:e=>{if(0!=e.code)c.warning(e.msg||"请求失败");else if("success"==e.msg&&(clearInterval(i.value),i.value=0,d.value="",c.success("登录成功"),v(),l.value=!1),"qr_state"==e.msg)switch(e.data.data){case"confirm":d.value="已扫码";break;case"timeout":d.value="二维码已过期";break;case"done":clearInterval(i.value),i.value=0,d.value="",c.success("登录成功"),v(),l.value=!1;break;default:d.value=""}},onError:e=>{c.error(e.message)}}),F=Y({mutationFn:async()=>await me({}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"获取失败"):(o.value=e.data.data,i.value=setInterval(S.mutate,3e3),l.value=!0)},onError:e=>{c.error(e.message)}}),U=Y({mutationFn:async e=>await fe({id:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"请求失败"):v()},onError:e=>{c.error(e.message)}}),j=Y({mutationFn:async e=>await pe({id:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"请求失败"):c.success("刷新完成"),n.value=!1},onError:e=>{c.error(e.message)}}),q=e=>{x.confirm("是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>U.mutate(e)).catch(e=>{"string"==typeof e&&"cancel"==e||c.error(e)})},C=e=>{n.value=!0,j.mutate(e)},T=()=>{clearInterval(i.value),i.value=0};return ee(g,()=>{_.value&&(r.value=_.value)}),(a,n)=>{const i=D,u=s,c=y,f=h,_=e,v=w,b=m;return O(),I(R,null,[H(_,null,{header:A(()=>[G("div",Be,[H(i,{class:"flex items-center",title:"账号设置"}),H(u,{title:"未登录账号无法获取到弹幕用户昵称等信息，如有需要可添加一个小号",type:"warning",closable:!1,style:{"margin-top":"1rem"}})])]),default:A(()=>[G("div",ze,[H(N(t),{type:"primary",onClick:n[0]||(n[0]=e=>N(F).mutate())},{default:A(()=>[...n[2]||(n[2]=[W("新增",-1)])]),_:1})]),ae((O(),I("div",Le,[H(f,null,{default:A(({width:e,height:a})=>[H(c,{columns:p,data:N(r),width:e,height:a,fixed:""},null,8,["data","width","height"])]),_:1})])),[[b,N(g)]])]),_:1}),H(v,{modelValue:N(l),"onUpdate:modelValue":n[1]||(n[1]=e=>J(l)?l.value=e:null),title:"新增",width:"720","destroy-on-close":"",onClose:T},{default:A(()=>[G("div",Ie,[G("img",{src:N(o),alt:"qrcode",class:"qcode",referrerpolicy:"no-referrer"},null,8,Oe),N(d).length>0?(O(),I("div",Re,Q(N(d)),1)):$("",!0)])]),_:1},8,["modelValue"])],64)}}}),Me={class:"card-header"},Ae=K({__name:"bili-tab",setup(i){const o=z(),s=B({id:0,room_id:0,modal_level:1,user_level:0,sing_prefix:"点歌",sing_cd:0}),d=ge(),r=[{key:"普通用户",value:0},{key:"舰长",value:3},{key:"提督",value:2},{key:"总督",value:1}],{data:u,refetch:f,isFetching:p}=le({queryKey:[_e.name],queryFn:async()=>{const e=await _e({});return 0!=e.code?(c.warning(e.msg||"请求失败"),{id:0,room_id:0,modal_level:1,user_level:0,sing_prefix:"点歌",sing_cd:0}):e.data.data}}),_=Y({mutationFn:async e=>await ve({data:e}),onSuccess:e=>{0!=e.code?c.warning(e.msg||"请求失败"):(c.success("操作成功"),f(),d.clearDanmakuList("bilibili"))},onError:e=>{c.error(e.message)}});return ee(p,()=>{u&&u.value&&(s.id=u.value.id,s.room_id=u.value.room_id,s.modal_level=u.value.modal_level,s.user_level=u.value.user_level,s.sing_prefix=u.value.sing_prefix,s.sing_cd=u.value.sing_cd)}),(i,d)=>{const u=D,f=g,h=l,y=S,w=V,b=n,k=a,x=e,F=v,U=He,j=m;return O(),I(R,null,[H(x,null,{header:A(()=>[G("div",Me,[H(u,{class:"flex items-center",title:"基础设置"})])]),default:A(()=>[ae((O(),M(k,{ref_key:"refForm",ref:o,model:N(s),"label-width":"auto"},{default:A(()=>[H(h,{label:"房间号",prop:"room_id"},{default:A(()=>[H(f,{modelValue:N(s).room_id,"onUpdate:modelValue":d[0]||(d[0]=e=>N(s).room_id=e),placeholder:"B站直播间号",min:1,controls:!1},null,8,["modelValue"])]),_:1}),H(h,{label:"粉丝牌等级",prop:"modal_level"},{default:A(()=>[H(f,{modelValue:N(s).modal_level,"onUpdate:modelValue":d[1]||(d[1]=e=>N(s).modal_level=e),placeholder:"粉丝牌等级",min:0,controls:!1},null,8,["modelValue"])]),_:1}),H(h,{label:"用户等级",prop:"user_level"},{default:A(()=>[H(w,{modelValue:N(s).user_level,"onUpdate:modelValue":d[2]||(d[2]=e=>N(s).user_level=e)},{default:A(()=>[(O(),I(R,null,P(r,(e,a)=>H(y,{key:a,value:e.value},{default:A(()=>[W(Q(e.key),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),H(h,{label:"点歌指令",prop:"sing_prefix"},{default:A(()=>[H(b,{modelValue:N(s).sing_prefix,"onUpdate:modelValue":d[3]||(d[3]=e=>N(s).sing_prefix=e),placeholder:"点歌指令",type:"text",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),H(h,{label:"点歌cd",prop:"sing_cd"},{default:A(()=>[H(f,{modelValue:N(s).sing_cd,"onUpdate:modelValue":d[4]||(d[4]=e=>N(s).sing_cd=e),placeholder:"点歌cd，单位：秒",min:0,controls:!1},null,8,["modelValue"])]),_:1}),H(h,null,{default:A(()=>[H(N(t),{type:"primary",onClick:d[5]||(d[5]=e=>{"number"!=typeof s.room_id||s.room_id<1?c.warning("请输入正确的房间号"):"number"!=typeof s.modal_level||s.modal_level<0?c.warning("请输入正确的粉丝牌等级"):0!=s.sing_prefix.length?"number"!=typeof s.sing_cd||s.sing_cd<0?c.warning("请输入正确的点歌cd"):_.mutate(s):c.warning("请输入正确的点歌指令")})},{default:A(()=>[...d[6]||(d[6]=[W("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])),[[j,N(p)]])]),_:1}),H(F),H(U)],64)}}}),Ge=K({name:"settings",__name:"index",setup(e){const a=z("1");return(e,l)=>{const n=Ae,t=j,i=Ke,o=De,s=U,d=F,r=q;return O(),M(r,{class:"settings-container"},{default:A(()=>[H(d,{class:"settings-main"},{default:A(()=>[H(s,{modelValue:N(a),"onUpdate:modelValue":l[0]||(l[0]=e=>J(a)?a.value=e:null),type:"border-card",class:"settings-tabs"},{default:A(()=>[H(t,{label:"哔哩哔哩设置",name:"1"},{default:A(()=>[H(n)]),_:1}),H(t,{label:"抖音设置",name:"2",lazy:""},{default:A(()=>[H(i)]),_:1}),H(t,{label:"应用设置",name:"3"},{default:A(()=>[H(o)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});"function"==typeof he&&he(Ge);export{Ge as default};
