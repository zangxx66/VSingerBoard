import{b as e,h as a,i as l,j as n,c as t,n as d,z as i,P as o,Q as s,R as r,f as u,E as c,v as m,S as p,T as f,U as _,o as g,I as v,M as h,N as b,t as y,V as w,D as k,F as x,G as V,H as C,e as U,W as S,X as j,d as B}from"./vendor-element-plus-DfIrH9Kr.js";import{_ as D,a as T}from"./fansMedal-DtyRymHF.js";import{n as O,L as q,a1 as I,r as R,V as z,x as L,t as H,K as E,q as F,D as G,y as K,u as M,I as W,a as A,ao as N,J as Q,G as J,H as P,ai as X,E as $,bf as Y}from"./vendor-libs-DGcKXZQv.js";import{b as Z,r as ee,d as ae}from"./index-CqzKlsTq.js";import"./vendor-exceljs-C-8i3j8b.js";import{u as le}from"./theme-D58fi9SQ.js";import{u as ne}from"./danmaku-UoKY8IM-.js";import"./vendor-vue-lxJqvpcP.js";const te=O({name:"lineHeader",props:{title:{type:String,required:!0}},setup:e=>()=>q("div",{class:"line-header"},[q("div",{class:"line-header-title"},[e.title])])}),de={class:"obs-container"},ie={class:"obs-splitter",style:{"margin-top":"1rem"}},oe={class:"css-editor"},se={class:"css-editor-preview"},re={class:"danmaku-container"},ue={class:"danmaku-list"},ce={class:"danmaku-list-item"},me={class:"danmaku-sing"},pe={class:"danmaku-uname"},fe={class:"danmaku-fans"},_e=O({__name:"obsSetting",setup(m){const p=I({url:`${window.location.origin}/danmaku`}),f=R("/* 弹幕列表CSS */\n.danmaku-container {\n    height: 600px;\n    width: 800px;\n    background: transparent;\n    overflow: hidden;\n}\n.danmaku-list {\n  padding: 0;\n  margin-left: 1%;\n  list-style: none;\n  overflow-y: auto;\n}\n.danmaku-list-item {\n    width: 450px;\n    display: flex;\n    align-items: center;\n    height: 50px;\n    text-align: left;\n    color: #000;\n    font-size: 16px;\n    font-weight: bold;\n    overflow: hidden;\n}\n.danmaku-source-img {\n    margin: 1px;\n    height: 24px;\n}\n.danmaku-sing {\n    width: 200px;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    overflow: hidden;\n}\n\n.danmaku-uname {\n  width: 180px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  margin-left: 1rem;\n}\n\n.danmaku-fans {\n  width: 200px;\n  margin: 0 auto;\n}\n\n.fans-club-img {\n  margin-left: 10px;\n}\n\n.fans-club-member-img {\n  margin-left: 10px;\n}\n\n.fans-medal-container {\n  margin-left: 10px;\n}\n\n.fans-club-container {\n  width: fit-content;\n  display: flex;\n  align-items: center;\n  margin-right: 1%;\n}\n\n.fans-club-name-container {\n  display: flex;\n  align-items: center;\n  font-size: 12px;\n  border-radius: 15px;\n  width: fit-content;\n  margin-left: 10px;\n}\n\n.fans-club-name-bg {\n  display: block;\n  height: 20px;\n}\n\n.fans-club-name {\n  color: #fff;\n  font-weight: 500;\n  width: 100%;\n  margin-left: -12%;\n}\n/* 弹幕列表CSS END */"),_=R(Array()),g=()=>{Z(p.url),c.success("拷贝成功")};return z(()=>{(()=>{for(let e=0;e<10;e++){const a=e%2==0?"bilibili":"douyin",l="bilibili"==a?0:e%3==0?1:2;_.value.push({msg_id:e,uid:e,msg:"点歌弹幕",uname:"username",medal_level:e,medal_name:"粉丝团",guard_level:l,source:a,send_time:Date.now()})}})()}),(c,m)=>{const v=d,h=t,b=n,y=l,w=a,k=o,x=te,V=r,C=u,U=D,S=T,j=s,B=e;return H(),L(E,null,[q(B,null,{header:G(()=>[...m[2]||(m[2]=[K("span",null,"OBS设置",-1)])]),default:G(()=>[K("div",de,[q(w,{model:M(p),"label-width":"auto"},{default:G(()=>[q(y,{label:"OBS地址",prop:"url"},{default:G(()=>[q(b,{modelValue:M(p).url,"onUpdate:modelValue":m[0]||(m[0]=e=>M(p).url=e),type:"text",disabled:""},{append:G(()=>[q(h,{type:"primary",onClick:g},{default:G(()=>[q(v,null,{default:G(()=>[q(M(i))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),q(y,null,{default:G(()=>[q(h,{type:"primary",onClick:g},{default:G(()=>[...m[3]||(m[3]=[W(" 复制地址 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),q(k,{title:"在OBS新建一个浏览器源，在地址栏输入上面复制的地址，即可实现与观众同步点歌板信息，如需使用自定义css样式，请到下方编辑，然后复制到OBS浏览器源中",closable:!1,type:"primary"}),K("div",ie,[q(j,null,{default:G(()=>[q(V,{resizable:!1},{default:G(()=>[K("div",oe,[q(x,{title:"样式编辑器"}),q(b,{modelValue:M(f),"onUpdate:modelValue":m[1]||(m[1]=e=>A(f)?f.value=e:null),rows:20,type:"textarea",placeholder:"css样式在这里编辑"},null,8,["modelValue"])])]),_:1}),q(V,{resizable:!1},{default:G(()=>[K("div",se,[q(x,{title:"样式预览"}),K("div",re,[K("div",ue,[(H(!0),L(E,null,N(M(_),e=>(H(),L("div",ce,[K("div",me,[null!=e.html&&e.html.length>0?(H(),F(C,{key:0,innerHTML:e.html,style:{display:"flex"}},null,8,["innerHTML"])):(H(),L(E,{key:1},[W(Q(e.msg),1)],64))]),K("div",pe,Q(e.uname),1),K("div",fe,[e.medal_level>0?(H(),L(E,{key:0},["bilibili"==e.source?(H(),F(U,{key:0,medal_name:e.medal_name,medal_level:e.medal_level,guard_level:e.guard_level},null,8,["medal_name","medal_level","guard_level"])):J("",!0),"douyin"==e.source?(H(),F(S,{key:1,medal_name:e.medal_name,medal_level:e.medal_level,guard_level:e.guard_level},null,8,["medal_name","medal_level","guard_level"])):J("",!0)],64)):J("",!0)])]))),256))])])])]),_:1})]),_:1})])])]),_:1}),(H(),F(P("style"),null,{default:G(()=>[W(Q(M(f)),1)]),_:1}))],64)}}}),ge=O({__name:"appSettingTab",setup(n,{expose:d}){const i=R(),o=R(!1),s=R(!1),r=le(),u=I({id:0,dark_mode:!1,check_update:!1,startup:!1,notification:!1,navSideTour:!1,collapse:!1});return X(()=>{const e=r.getDarkTheme();u.dark_mode=e}),d({initConfig:()=>{s.value=!0,ee.getGlobalConfig({}).then(e=>{const a=e.data;if(0!=a.code)c.warning(a.msg||"获取失败");else{const e=a.data.data;e&&Object.assign(u,e)}s.value=!1}).catch(e=>{c.error(e),s.value=!1})}}),(n,d)=>{const v=p,h=l,b=t,y=a,w=e,k=g,x=_e,V=m;return H(),L(E,null,[$((H(),F(w,null,{header:G(()=>[...d[5]||(d[5]=[K("div",{class:"card-header"},[K("span",null,"应用设置")],-1)])]),default:G(()=>[q(y,{model:M(u),ref_key:"refForm",ref:i,"label-width":"auto",inline:""},{default:G(()=>[q(h,{label:"黑暗模式",prop:"dark_mode"},{default:G(()=>[q(v,{modelValue:M(u).dark_mode,"onUpdate:modelValue":d[0]||(d[0]=e=>M(u).dark_mode=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":M(_),"inactive-icon":M(f)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),q(h,{label:"桌面通知",prop:"notification"},{default:G(()=>[q(v,{modelValue:M(u).notification,"onUpdate:modelValue":d[1]||(d[1]=e=>M(u).notification=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":M(_),"inactive-icon":M(f)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),q(h,{label:"自动检查更新",prop:"check_update"},{default:G(()=>[q(v,{modelValue:M(u).check_update,"onUpdate:modelValue":d[2]||(d[2]=e=>M(u).check_update=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":M(_),"inactive-icon":M(f)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),q(h,{label:"开机启动",prop:"startup"},{default:G(()=>[q(v,{modelValue:M(u).startup,"onUpdate:modelValue":d[3]||(d[3]=e=>M(u).startup=e),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":M(_),"inactive-icon":M(f)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),q(h,null,{default:G(()=>[$((H(),F(b,{type:"primary",onClick:d[4]||(d[4]=e=>(o.value=!0,void ee.addOrUpdateGlobalConfig({data:u}).then(e=>{const a=e.data;0!=a.code?c.warning(a.msg||"保存失败"):(u.id=a.data,c.success(a.msg||"保存成功"),ae(u.dark_mode),r.setDarkTheme(u.dark_mode)),o.value=!1}).catch(e=>{c.error(e),o.value=!1})))},{default:G(()=>[...d[6]||(d[6]=[W("保存",-1)])]),_:1})),[[V,M(o)]])]),_:1})]),_:1},8,["model"])]),_:1})),[[V,M(s)]]),q(k),q(x)],64)}}}),ve=O({__name:"dyTab",setup(d){const i=R(),o=R(!1),s=R(!1),r=I({id:0,room_id:0,sing_prefix:"点歌",sing_cd:0,fans_level:1}),u=ne(),p=()=>{"number"!=typeof r.room_id||r.room_id<1?c.warning("请输入正确的房间号"):0!=r.sing_prefix.length?"number"!=typeof r.sing_cd||r.sing_cd<0?c.warning("请输入正确的点歌cd"):"number"!=typeof r.fans_level||r.fans_level<0?c.warning("请输入正确的粉团等级"):(o.value=!0,ee.addOrUpdateDyConfig({data:r}).then(e=>{const a=e.data;0!=a.code?c.warning(a.msg):(c.success(a.msg),r.id=a.data,u.clearDanmakuList("douyin")),o.value=!1}).catch(e=>{c.error(e),o.value=!1})):c.warning("请输入正确的点歌指令")};return z(()=>{s.value=!0,ee.getDyConfig({}).then(e=>{const a=e.data;if(0!=a.code)c.warning(a.msg);else{if(!a.data.data)return void(s.value=!1);Object.assign(r,a.data.data)}s.value=!1}).catch(e=>{c.error(e),s.value=!1})}),(d,u)=>{const c=v,f=l,_=n,g=t,h=a,b=e,y=m;return H(),F(b,null,{header:G(()=>[...u[4]||(u[4]=[K("div",{class:"card-header"},[K("span",null,"抖音设置")],-1)])]),default:G(()=>[$((H(),F(h,{mode:M(r),ref_key:"refForm",ref:i,"label-width":"auto"},{default:G(()=>[q(f,{label:"房间号",prop:"room_id"},{default:G(()=>[q(c,{modelValue:M(r).room_id,"onUpdate:modelValue":u[0]||(u[0]=e=>M(r).room_id=e),min:1,controls:!1},null,8,["modelValue"])]),_:1}),q(f,{label:"点歌指令",prop:"sing_prefix"},{default:G(()=>[q(_,{modelValue:M(r).sing_prefix,"onUpdate:modelValue":u[1]||(u[1]=e=>M(r).sing_prefix=e),type:"text",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),q(f,{label:"点歌cd",prop:"sing_cd"},{default:G(()=>[q(c,{modelValue:M(r).sing_cd,"onUpdate:modelValue":u[2]||(u[2]=e=>M(r).sing_cd=e),placeholder:"点歌cd，单位：秒",min:0,controls:!1},null,8,["modelValue"])]),_:1}),q(f,{label:"粉团等级",prop:"fans_level"},{default:G(()=>[q(c,{modelValue:M(r).fans_level,"onUpdate:modelValue":u[3]||(u[3]=e=>M(r).fans_level=e),min:0,controls:!1},null,8,["modelValue"])]),_:1}),q(f,null,{default:G(()=>[$((H(),F(g,{type:"primary",onClick:p},{default:G(()=>[...u[5]||(u[5]=[W("保存",-1)])]),_:1})),[[y,M(o)]])]),_:1})]),_:1},8,["mode"])),[[y,M(s)]])]),_:1})}}}),he={class:"b-credential-card-header"},be={class:"mb-4 flex items-center"},ye={style:{height:"300px","padding-top":"1rem"}},we={class:"qcode-image-container"},ke=["src"],xe={key:0,class:"qcode-bage"},Ve=O({__name:"biliCredential",setup(a){const l=R(!1),n=R(!1),d=R(0),i=R(""),s=R(""),r=R(Array()),m=[{key:"uid",dataKey:"uid",title:"uid",width:200,cellRenderer:({cellData:e})=>q(u,null,{default:()=>[e,W(" ")]})},{key:"uname",dataKey:"uname",title:"昵称",width:300,cellRenderer:({cellData:e})=>q(u,null,{default:()=>[e,W(" ")]})},{key:"enable",dataKey:"enable",title:"是否启用",width:150,cellRenderer:({rowData:e})=>q(p,{modelValue:e.enable,"inline-prompt":!0,style:"--el-switch-off-color: #ff4949; --el-switch-on-color: #13ce66",activeText:"启用",inactiveText:"禁用",onChange:a=>{e.enable=a,_(a,e.id)}},{default:()=>[" "]})},{key:"operations",title:"操作",width:200,maxWidth:1020,minWidth:100,cellRenderer:({rowData:e})=>q(E,null,[q(t,{type:"success",icon:w,loading:n.value,onClick:a=>C(e.id)},{default:()=>[W("刷新凭证")]}),q(t,{type:"danger",icon:k,onClick:a=>V(e.id)},{default:()=>[W("删除")]})])}],f=()=>{ee.getBiliCredentialList({}).then(e=>{const a=e.data;0!=a.code?c.warning(a.msg):r.value=a.data.rows}).catch(e=>{c.error(e)})},_=(e,a)=>{ee.updateBiliCredential({data:{id:a,enable:e}}).then(l=>{const n=l.data;if(0!=n.code)return c.warning(n.msg||"设置失败"),void g(a,!e);c.success(n.msg||"设置成功"),r.value.forEach((l,n,t)=>{l.id!=a&&(l.enable=!e)})}).catch(l=>{c.error(l),g(a,!e)})},g=(e,a)=>{const l=r.value.findIndex(a=>a.id===e);-1!==l&&(r.value[l].enable=a)},v=()=>{ee.getBiliCredentialCode({}).then(e=>{const a=e.data;0==a.code?(i.value=a.data.data,d.value=setInterval(U,3e3),l.value=!0):c.warning(a.msg)}).catch(e=>c.error(e))},V=e=>{x.confirm("是否删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>ee.deleteBiliCredential({id:e})).then(a=>{const l=a.data;if(0!=l.code)c.warning(l.msg);else{c.success(l.msg);const a=r.value.filter(a=>a.id!=e);r.value=a}}).catch(e=>{"string"==typeof e&&"cancel"==e||c.error(e)})},C=e=>{n.value=!0,ee.refreshBiliCredential({id:e}).then(e=>{const a=e.data;0!=a.code?c.warning(a.msg):c.success("success"),n.value=!1}).catch(e=>{c.error(e),n.value=!1})},U=()=>{ee.checkQrCode({}).then(e=>{const a=e.data;if(0==a.code){if("success"==a.msg&&(clearInterval(d.value),d.value=0,s.value="",c.success("登录成功"),f(),l.value=!1),"qr_state"==a.msg)switch(a.data.data){case"confirm":s.value="已扫码";break;case"timeout":s.value="二维码已过期";break;case"done":clearInterval(d.value),d.value=0,s.value="",c.success("登录成功"),f(),l.value=!1;break;default:s.value=""}}else c.warning(a.msg||"二维码状态请求错误")}).catch(e=>c.error(e))},S=()=>{clearInterval(d.value),d.value=0};return z(()=>{f()}),(a,n)=>{const d=o,u=b,c=h,p=e,f=y;return H(),L(E,null,[q(p,null,{header:G(()=>[K("div",he,[n[1]||(n[1]=K("span",null,"账号设置",-1)),q(d,{title:"未登录账号无法获取到弹幕用户昵称等信息，如有需要可添加一个小号",type:"warning",closable:!1,style:{"margin-top":"1rem"}})])]),default:G(()=>[K("div",be,[q(M(t),{type:"primary",onClick:v},{default:G(()=>[...n[2]||(n[2]=[W("新增",-1)])]),_:1})]),K("div",ye,[q(c,null,{default:G(({width:e,height:a})=>[q(u,{columns:m,data:M(r),width:e,height:a,fixed:""},null,8,["data","width","height"])]),_:1})])]),_:1}),q(f,{modelValue:M(l),"onUpdate:modelValue":n[0]||(n[0]=e=>A(l)?l.value=e:null),title:"新增",width:"720",onClose:S,"destroy-on-close":""},{default:G(()=>[K("div",we,[K("img",{src:M(i),alt:"qrcode",class:"qcode",referrerpolicy:"no-referrer"},null,8,ke),M(s).length>0?(H(),L("div",xe,Q(M(s)),1)):J("",!0)])]),_:1},8,["modelValue"])],64)}}}),Ce=O({__name:"biliTab",setup(d){const i=R(),o=R(!1),s=I({id:0,room_id:0,modal_level:1,user_level:0,sing_prefix:"点歌",sing_cd:0}),r=ne(),u=[{key:"普通用户",value:0},{key:"舰长",value:3},{key:"提督",value:2},{key:"总督",value:1}];return z(()=>{o.value=!0,ee.getBiliConfig({}).then(e=>{const a=e.data;if(0!=a.code)c.warning(a.msg);else{const e=a.data.data;e&&Object.assign(s,e)}o.value=!1}).catch(e=>{c.error(e),o.value=!1})}),(d,p)=>{const f=v,_=l,h=C,b=V,y=n,w=a,k=e,x=g,U=Ve,S=m;return $((H(),L("div",null,[q(k,null,{header:G(()=>[...p[6]||(p[6]=[K("div",{class:"card-header"},[K("span",null,"基础设置")],-1)])]),default:G(()=>[q(w,{model:M(s),ref_key:"refForm",ref:i,"label-width":"auto"},{default:G(()=>[q(_,{label:"房间号",prop:"room_id"},{default:G(()=>[q(f,{modelValue:M(s).room_id,"onUpdate:modelValue":p[0]||(p[0]=e=>M(s).room_id=e),placeholder:"B站直播间号",min:1,controls:!1},null,8,["modelValue"])]),_:1}),q(_,{label:"粉丝牌等级",prop:"modal_level"},{default:G(()=>[q(f,{modelValue:M(s).modal_level,"onUpdate:modelValue":p[1]||(p[1]=e=>M(s).modal_level=e),placeholder:"粉丝牌等级",min:0,controls:!1},null,8,["modelValue"])]),_:1}),q(_,{label:"用户等级",prop:"user_level"},{default:G(()=>[q(b,{modelValue:M(s).user_level,"onUpdate:modelValue":p[2]||(p[2]=e=>M(s).user_level=e)},{default:G(()=>[(H(),L(E,null,N(u,e=>q(h,{value:e.value},{default:G(()=>[W(Q(e.key),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1}),q(_,{label:"点歌指令",prop:"sing_prefix"},{default:G(()=>[q(y,{modelValue:M(s).sing_prefix,"onUpdate:modelValue":p[3]||(p[3]=e=>M(s).sing_prefix=e),placeholder:"点歌指令",type:"text",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),q(_,{label:"点歌cd",prop:"sing_cd"},{default:G(()=>[q(f,{modelValue:M(s).sing_cd,"onUpdate:modelValue":p[4]||(p[4]=e=>M(s).sing_cd=e),placeholder:"点歌cd，单位：秒",min:0,controls:!1},null,8,["modelValue"])]),_:1}),q(_,null,{default:G(()=>[q(M(t),{type:"primary",onClick:p[5]||(p[5]=e=>{"number"!=typeof s.room_id||s.room_id<1?c.warning("请输入正确的房间号"):"number"!=typeof s.modal_level||s.modal_level<0?c.warning("请输入正确的粉丝牌等级"):0!=s.sing_prefix.length?"number"!=typeof s.sing_cd||s.sing_cd<0?c.warning("请输入正确的点歌cd"):ee.addOrUpdateBiliConfig({data:s}).then(e=>{const a=e.data;0!=a.code?c.warning(a.msg):(c.success(a.msg),s.id=a.data,r.clearDanmakuList("bilibili"))}).catch(e=>c.error(e)):c.warning("请输入正确的点歌指令")})},{default:G(()=>[...p[7]||(p[7]=[W("保存",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),q(x),q(U)])),[[S,M(o)]])}}}),Ue=O({__name:"index",setup(e){const a=R("1"),l=Y("appSettingRef"),n=(e,a)=>{3==e.props.name&&l.value?.initConfig()};return(e,t)=>{const d=Ce,i=j,o=ve,s=ge,r=S,u=U,c=B;return H(),F(c,{class:"settings-container"},{default:G(()=>[q(u,{class:"settings-main"},{default:G(()=>[q(r,{modelValue:M(a),"onUpdate:modelValue":t[0]||(t[0]=e=>A(a)?a.value=e:null),type:"border-card",class:"settings-tabs",onTabClick:n},{default:G(()=>[q(i,{label:"哔哩哔哩设置",name:"1"},{default:G(()=>[q(d)]),_:1}),q(i,{label:"抖音设置",name:"2",lazy:""},{default:G(()=>[q(o)]),_:1}),q(i,{label:"应用设置",name:"3"},{default:G(()=>[q(s,{ref_key:"appSettingRef",ref:l},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Ue as default};
