import{V as e,W as a,i as t,X as l,Y as s,Z as o,_ as n,m as r,z as i,$ as u,a0 as d,a1 as c,a2 as m,a3 as f,a4 as p,E as g,a5 as _,a6 as v,a7 as h}from"./vendor-element-plus-CjYS7DoP.js";import{o as k,M as y,a2 as b,bd as w,r as x,bb as C,c as T,V as j,t as S,E as N,u as R,y as $,ap as E,L as V,H as D,a0 as I,an as L,bj as M,I as z,b as F,Z as H,v as O,J as U,K as W,b9 as Z}from"./vendor-libs-Kq5ll9xE.js";import{r as A,c as G,b as J}from"./api-BnBC17YJ.js";import{u as K}from"./theme-DiWkF22v.js";import{y as X,z as Y}from"./vendor-vue-QPsD10U7.js";import{u as q,t as B}from"./dark-vtBTDSxL.js";import"./vendor-exceljs-C-8i3j8b.js";const P=((e,a)=>{const t=e.__vccOpts||e;for(const[l,s]of a)t[l]=s;return t})(k({name:"defaultLayout",__name:"default",setup(k){const P=K(),Q=X(),ee=Y(),ae={shadow:"always"},te={alignCenter:!0,draggable:!0,overflow:!1,transition:"el-fade-in"},le={offset:70,plain:!0},se=[{title:"点歌板",icon:y(u,null,null),routerName:"/",ref:"homeRef"},{title:"点歌记录",icon:y(d,null,null),routerName:"/history",ref:"historyRef"},{title:"歌单管理",icon:y(c,null,null),routerName:"/playlist",ref:"playlistRef"},{title:"更新日志",icon:y(m,null,null),routerName:"/changelog"},{title:"设置",icon:y(f,null,null),routerName:"/settings",ref:"settingsRef"},{title:"关于",icon:y(p,null,null),routerName:"/about"}],oe=b({id:0,dark_mode:!1,check_update:!1,startup:!1,notification:!1,navSideTour:!1,collapse:!1}),{data:ne,isFetching:re}=q(),ie=w({mutationFn:async e=>await A.addOrUpdateGlobalConfig({data:e}),onSuccess:e=>{0!=e.code?g.warning(e.msg||"请求异常"):oe.id=e.data},onError:e=>{g.error(e.message)}}),ue=x(!1),de=x(),ce=x(),me=x(),fe=x(),pe=C("mainRef"),ge=()=>{oe.navSideTour=!0,ie.mutate(oe),ue.value=!1},_e=async()=>{await H(),oe.navSideTour||(oe.navSideTour=!0,ie.mutate(oe),ue.value=!1)},ve=async e=>{e.preventDefault();const a=window.getSelection()?.toString(),t=document.activeElement,l=t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement;let s=!1;const o=await window.pywebview.api.check_clipboard();o&&o.length>0&&(s=!0);const n=[{label:"拷贝",disabled:!a,onClick:()=>{a&&(G(a),g.success("拷贝成功"))}},{label:"粘贴",disabled:!l||!s,onClick:()=>{J(t)}}];Z.showContextMenu({x:e.x,y:e.y,theme:be.value?"mac dark":"mac",zIndex:9999,minWidth:230,items:n})},he=()=>{oe.dark_mode=!oe.dark_mode,ie.mutate(oe),B(oe.dark_mode),P.setDarkTheme(oe.dark_mode)},ke=T(()=>({left:oe.collapse?"64px":"200px"})),ye=T(()=>({width:oe.collapse?"64px":"200px"})),be=T(()=>P.getDarkTheme());return j(re,()=>{ne.value&&(()=>{const e=ne.value;e?(Object.assign(oe,e),B(e.dark_mode),P.setDarkTheme(e.dark_mode),e.navSideTour||(ue.value=!0)):ue.value=!0})()},{once:!0}),(u,d)=>{const c=t,m=a,f=e,p=n,g=L("router-view"),k=o,b=s,w=l,x=r,C=i;return O(),S(C,{class:"layout-container-demo"},{default:N(()=>[y(p,{style:I(R(ye))},{default:N(()=>[y(f,{"default-active":"0",collapse:R(oe).collapse,class:"layout-aside-menu"},{default:N(()=>[(O(),$(V,null,E(se,(e,a)=>y(m,{key:a,index:`${a}`,onClick:a=>(e=>{if(Q.path==e)return oe.collapse=!oe.collapse,void ie.mutate(oe);ee.push({path:e})})(e.routerName),ref_for:!0,ref:e.ref||void 0},{title:N(()=>[U(W(e.title),1)]),default:N(()=>[y(c,null,{default:N(()=>[(O(),S(z(e.icon)))]),_:2},1024)]),_:2},1032,["index","onClick"])),64)),y(m,{ref_key:"themeRef",ref:fe,onClick:he},{default:N(()=>[R(be)?D("",!0):(O(),S(c,{key:0},{default:N(()=>[y(R(_))]),_:1})),R(be)?(O(),S(c,{key:1},{default:N(()=>[y(R(v))]),_:1})):D("",!0)]),_:1},512)]),_:1},8,["collapse"])]),_:1},8,["style"]),y(x,{onContextmenu:ve,style:I(R(ke)),ref_key:"mainRef",ref:pe},{default:N(()=>[y(w,{locale:R(h),card:ae,dialog:te,message:le},{default:N(()=>[y(g,null,{default:N(({Component:e})=>[(O(),S(M,{include:["home"]},[(O(),S(z(e)))],1024))]),_:1}),y(b,{modelValue:R(ue),"onUpdate:modelValue":d[0]||(d[0]=e=>F(ue)?ue.value=e:null),onClose:_e,onFinish:ge,"target-area-clickable":!1,"close-on-press-escape":!1},{default:N(()=>[y(k,{title:"提示",description:"欢迎使用点歌姬"}),y(k,{title:"提示",description:"这里是点歌，可以查看抖和破站的点歌列表",placement:"right",target:R(de)?.$el},null,8,["target"]),y(k,{title:"提示",description:"这里是历史记录，可以查看历史点歌",placement:"right",target:R(ce)?.$el},null,8,["target"]),y(k,{title:"提示",description:"这里是设置，可以设置抖和破站的直播间监听",placement:"right",target:R(me)?.$el},null,8,["target"]),y(k,{title:"提示",description:"这是主题开关，可以切换主题",placement:"right",target:R(fe)?.$el},null,8,["target"]),y(k,{title:"提示",description:"这里是主界面",placement:"left",target:R(pe)?.$el},null,8,["target"])]),_:1},8,["modelValue"])]),_:1},8,["locale"])]),_:1},8,["style"])]),_:1})}}}),[["__scopeId","data-v-f125c9a6"]]);export{P as default};
