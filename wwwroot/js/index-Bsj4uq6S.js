import{k as e,d as a,w as l,x as s}from"./vendor-element-plus-C1FTue0a.js";import{_ as n,a as m}from"./fansMedal-DD3jFonr.js";import{p as d}from"./index-VsYnm2nK.js";import"./vendor-exceljs-C-8i3j8b.js";import{C as t}from"./vendor-vue-J6GVTi4e.js";import{n as u,r,U as o,V as i,q as v,D as _,L as c,E as g,x as f,K as p,ao as k,u as y,t as h,y as j,I as b,J as x,G as L,Y as M}from"./vendor-libs-HLQpMz2o.js";const T={class:"danmaku-list-item"},w={class:"danmaku-sing"},H={class:"danmaku-uname"},C={class:"danmaku-fans"},J=u({name:"danmaku",setup(u){const J=r(Array()),q=r(null),A=()=>{},D={echo:()=>{},clear:()=>{J.value=[]},remove:e=>{J.value=J.value.filter(a=>a.msg_id!=e)},del:e=>{J.value=J.value.filter(a=>!e.some(e=>e.msg_id===a.msg_id))},add:e=>{J.value=[...J.value,...d(e)]}};return o(J,async()=>{await M(),q.value&&q.value.scrollTo({behavior:"smooth",top:q.value.scrollHeight})}),i(()=>{document.title="点歌列表",t("ws://127.0.0.1:8080",{autoReconnect:!0,autoClose:!0,heartbeat:{message:'{"type":"echo","data":"heartbeat"}',interval:5e3,pongTimeout:1e4},onMessage:(e,a)=>{const l=JSON.parse(a.data),s=D[l.type];s&&s(l.data)}})}),(d,t)=>{const u=l,r=n,o=m,i=e,M=a,D=s;return h(),v(M,{class:"danmaku-container"},{default:_(()=>[c(i,null,{default:_(()=>[g((h(),f("div",{class:"danmaku-list",ref_key:"infiniteList",ref:q},[(h(!0),f(p,null,k(y(J),e=>(h(),f("div",T,[j("div",w,[null!=e.html&&e.html.length>0?(h(),v(u,{key:0,innerHTML:e.html,style:{display:"flex"}},null,8,["innerHTML"])):(h(),f(p,{key:1},[b(x(e.msg),1)],64))]),j("div",H,x(e.uname),1),j("div",C,[e.medal_level>0?(h(),f(p,{key:0},["bilibili"==e.source?(h(),v(r,{key:0,medal_name:e.medal_name,medal_level:e.medal_level,guard_level:e.guard_level},null,8,["medal_name","medal_level","guard_level"])):L("",!0),"douyin"==e.source?(h(),v(o,{key:1,medal_name:e.medal_name,medal_level:e.medal_level,guard_level:e.guard_level},null,8,["medal_name","medal_level","guard_level"])):L("",!0)],64)):L("",!0)])]))),256))])),[[D,A]])]),_:1})]),_:1})}}});export{J as default};
