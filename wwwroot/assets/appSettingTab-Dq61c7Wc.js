import{d as x,r as u,bw as F,b as U,o as B,e as f,f as _,w as l,k as n,y as i,aq as k,bx as v,m as S,aK as G,u as I,aI as N,A as g,h as b,E as s,by as T,bz as q}from"./index-ChAUYrtk.js";/* empty css                   */import{E as D}from"./el-card-Bpcb9mwR.js";import{E as L,a as M}from"./el-form-item-DUXHibzR.js";/* empty css                  */import{E as O}from"./index-CtvcLVhF.js";import"./Settings-DZOER_pg.js";import"./toNumber-Bqw2R8PT.js";const R=x({__name:"appSettingTab",setup(z){const h=u(),d=u(!1),p=F(),a=U({id:0,dark_mode:!1,check_update:!1,startup:!1}),m=()=>{b.getGlobalConfig({}).then(t=>{const e=t.data;if(e.code!=0)s.warning(e.msg||"获取失败");else{const r=e.data.data;if(r){const o=r;a.id=o.id,a.dark_mode=o.dark_mode,a.check_update=o.check_update,a.startup=o.startup}}}).catch(t=>{s.error(t),console.error("getGlobalConfig",t)})},w=()=>{d.value=!0,b.addOrUpdateGlobalConfig({data:a}).then(t=>{const e=t.data;e.code!=0?s.warning(e.msg||"保存失败"):(s.success(e.msg||"保存成功"),T(a.dark_mode),a.check_update?(p.addCallback("check_update",q),p.start(1e3*60*60*6)):p.removeCallback("check_update"),m()),d.value=!1}).catch(t=>{s.error(t),d.value=!1})};return B(()=>{m()}),(t,e)=>{const r=O,o=M,C=G,E=L,V=D,y=N;return _(),f(V,null,{header:l(()=>[...e[3]||(e[3]=[g("div",{class:"card-header"},[g("span",null,"应用设置")],-1)])]),default:l(()=>[n(E,{model:a,ref_key:"refForm",ref:h,"label-width":"auto"},{default:l(()=>[n(o,{label:"黑暗模式",prop:"dark_mode"},{default:l(()=>[n(r,{modelValue:a.dark_mode,"onUpdate:modelValue":e[0]||(e[0]=c=>a.dark_mode=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),n(o,{label:"自动检查更新",prop:"check_update"},{default:l(()=>[n(r,{modelValue:a.check_update,"onUpdate:modelValue":e[1]||(e[1]=c=>a.check_update=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),n(o,{label:"开机启动",prop:"startup"},{default:l(()=>[n(r,{"model-value":a.startup,"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-text":"开",inactiveText:"关"},null,8,["model-value"])]),_:1}),n(o,null,{default:l(()=>[S((_(),f(C,{type:"primary",onClick:e[2]||(e[2]=c=>w())},{default:l(()=>[...e[4]||(e[4]=[I("保存",-1)])]),_:1})),[[y,d.value]])]),_:1})]),_:1},8,["model"])]),_:1})}}});export{R as default};
