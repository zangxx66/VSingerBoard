import{j as W,I as X,au as Y,N as q,d as M,av as G,Q,a3 as Z,X as C,c as T,o as v,aw as y,ap as V,ag as z,Z as h,u as _,w as p,a as m,aa as A,ax as D,a7 as x,Y as F,ay as J,ar as ee,U as H,az as te,P as ne,aA as ae,R as $,am as se,a4 as oe,W as le,aB as ie,b as ce,ao as re,aC as de,aD as ue,aE as fe,at as P,aF as B,E as _e,aG as N,h as pe}from"./index-B7049lEm.js";import{E as me}from"./el-card-Cl25xTtL.js";import{d as ge,r as ve}from"./request-DLLc11SG.js";var be="Expected a function";function R(e,a,t){var o=!0,s=!0;if(typeof e!="function")throw new TypeError(be);return W(t)&&(o="leading"in t?!!t.leading:o,s="trailing"in t?!!t.trailing:s),ge(e,a,{leading:o,maxWait:a,trailing:s})}const he=X({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Y},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),ye={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},Ee=M({name:"ElTag"}),Ce=M({...Ee,props:he,emits:ye,setup(e,{emit:a}){const t=e,o=G(),s=Q("tag"),u=Z(()=>{const{type:n,hit:l,effect:r,closable:g,round:b}=t;return[s.b(),s.is("closable",g),s.m(n||"primary"),s.m(o.value),s.m(r),s.is("hit",l),s.is("round",b)]}),c=n=>{a("close",n)},f=n=>{a("click",n)},i=n=>{var l,r,g;(g=(r=(l=n?.component)==null?void 0:l.subTree)==null?void 0:r.component)!=null&&g.bum&&(n.component.subTree.component.bum=null)};return(n,l)=>n.disableTransitions?(v(),C("span",{key:0,class:h(_(u)),style:F({backgroundColor:n.color}),onClick:f},[y("span",{class:h(_(s).e("content"))},[z(n.$slots,"default")],2),n.closable?(v(),T(_(x),{key:0,class:h(_(s).e("close")),onClick:D(c,["stop"])},{default:p(()=>[m(_(A))]),_:1},8,["class","onClick"])):V("v-if",!0)],6)):(v(),T(J,{key:1,name:`${_(s).namespace.value}-zoom-in-center`,appear:"",onVnodeMounted:i},{default:p(()=>[y("span",{class:h(_(u)),style:F({backgroundColor:n.color}),onClick:f},[y("span",{class:h(_(s).e("content"))},[z(n.$slots,"default")],2),n.closable?(v(),T(_(x),{key:0,class:h(_(s).e("close")),onClick:D(c,["stop"])},{default:p(()=>[m(_(A))]),_:1},8,["class","onClick"])):V("v-if",!0)],6)]),_:3},8,["name"]))}});var Te=q(Ce,[["__file","tag.vue"]]);const Se=ee(Te),U=e=>{let a=0,t=e;for(;t;)a+=t.offsetTop,t=t.offsetParent;return a},ke=(e,a)=>Math.abs(U(e)-U(a)),d="ElInfiniteScroll",we=50,Be=200,Ne=0,Ie={delay:{type:Number,default:Be},distance:{type:Number,default:Ne},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},O=(e,a)=>Object.entries(Ie).reduce((t,[o,s])=>{var u,c;const{type:f,default:i}=s,n=e.getAttribute(`infinite-scroll-${o}`);let l=(c=(u=a[n])!=null?u:n)!=null?c:i;return l=l==="false"?!1:l,l=f(l),t[o]=Number.isNaN(l)?i:l,t},{}),j=e=>{const{observer:a}=e[d];a&&(a.disconnect(),delete e[d].observer)},xe=(e,a)=>{const{container:t,containerEl:o,instance:s,observer:u,lastScrollTop:c}=e[d],{disabled:f,distance:i}=O(e,s),{clientHeight:n,scrollHeight:l,scrollTop:r}=o,g=r-c;if(e[d].lastScrollTop=r,u||f||g<0)return;let b=!1;if(t===e)b=l-(n+r)<=i;else{const{clientTop:S,scrollHeight:k}=e,w=ke(e,o);b=r+n>=w+S+k-i}b&&a.call(s)};function I(e,a){const{containerEl:t,instance:o}=e[d],{disabled:s}=O(e,o);s||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?a.call(o):j(e))}const Le={async mounted(e,a){const{instance:t,value:o}=a;te(o)||ne(d,"'v-infinite-scroll' binding value must be a function"),await H();const{delay:s,immediate:u}=O(e,t),c=ae(e,!0),f=c===window?document.documentElement:c,i=R(xe.bind(null,e,o),s);if(c){if(e[d]={instance:t,container:c,containerEl:f,delay:s,cb:o,onScroll:i,lastScrollTop:f.scrollTop},u){const n=new MutationObserver(R(I.bind(null,e,o),we));e[d].observer=n,n.observe(e,{childList:!0,subtree:!0}),I(e,o)}c.addEventListener("scroll",i)}},unmounted(e){if(!e[d])return;const{container:a,onScroll:t}=e[d];a?.removeEventListener("scroll",t),j(e)},async updated(e){if(!e[d])await H();else{const{containerEl:a,cb:t,observer:o}=e[d];a.clientHeight&&o&&I(e,t)}}},L=Le;L.install=e=>{e.directive("InfiniteScroll",L)};const Me=L,Oe={class:"infinite-list"},Ve=["onClick"],ze=M({__name:"biliChat",setup(e){const a=$(Array()),t=se({id:0,room_id:0,modal_level:0,user_level:0,sing_prefix:"点歌",sing_cd:0}),o=$(0),s=()=>{ve.getBiliConfig({}).then(i=>{const n=i.data;if(n.code!=0)N.warning(n.msg);else{const l=n.data.data;t.id=l.id,t.room_id=l.room_id,t.modal_level=l.modal_level,t.user_level=l.user_level,t.sing_prefix=l.sing_prefix,t.sing_cd=l.sing_cd,u()}}).catch(i=>N.error(i))},u=()=>{setInterval(async()=>{const i=await window.pywebview.api.get_danmu();i&&i.forEach((n,l,r)=>{t.user_level==0&&n.medal_level>=t.modal_level&&a.value.push(n),t.user_level!=0&&n.guard_level<=t.user_level&&a.value.push(n)})},1e3)},c=()=>console.log("load"),f=async i=>{await navigator.clipboard.writeText(i),N.success("复制成功")};return oe(()=>{s()}),le(()=>{clearInterval(o.value),o.value=0}),(i,n)=>{const l=Se,r=fe,g=ie("CloseBold"),b=x,S=me,k=ce,w=_e,K=Me;return v(),T(w,{class:"chat-container"},{default:p(()=>[m(k,{class:"chat-main"},{default:p(()=>[m(S,{class:"chat-card"},{header:p(()=>[...n[0]||(n[0]=[y("div",{class:"card-header"},[y("span",null,"点歌列表")],-1)])]),default:p(()=>[re((v(),C("div",Oe,[(v(!0),C(de,null,ue(a.value,E=>(v(),C("div",{class:"infinite-list-item",onClick:Ae=>f(E.msg)},[m(r,{tag:"span",class:"chat-tag"},{default:p(()=>[m(l,{type:"primary"},{default:p(()=>[P(B(E.medal_name)+" Lv"+B(E.medal_level),1)]),_:2},1024),P(" "+B(E.uname),1)]),_:2},1024),m(r,{tag:"span",class:"chat-close"},{default:p(()=>[m(b,null,{default:p(()=>[m(g)]),_:1})]),_:1})],8,Ve))),256))])),[[K,c]])]),_:1})]),_:1})]),_:1})}}}),$e=pe(ze,[["__scopeId","data-v-47071ca1"]]);export{$e as default};
