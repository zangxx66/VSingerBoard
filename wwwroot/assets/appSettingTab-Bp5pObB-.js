import{d as x,r as u,bw as F,b as U,o as B,e as f,f as _,w as l,k as n,y as i,aq as k,bx as v,m as S,aK as G,u as I,aI as N,A as g,h as b,E as r,by as q,bz as D}from"./index-DWcLJc42.js";/* empty css                   */import{E as L}from"./el-card-BhNH090Q.js";import{E as M,a as O}from"./el-form-item-X2s0LD7M.js";/* empty css                  */import{E as T}from"./index-CwnjTpRE.js";import"./Settings-B0lAhPes.js";import"./toNumber-DS4UdUg_.js";const R=x({__name:"appSettingTab",setup(z){const h=u(),d=u(!1),m=F(),a=U({id:0,dark_mode:!1,check_update:!1,startup:!1}),p=()=>{b.getGlobalConfig({}).then(t=>{const e=t.data;if(e.code!=0)r.warning(e.msg||"获取失败");else{const s=e.data.data;if(s){const o=s;a.id=o.id,a.dark_mode=o.dark_mode,a.check_update=o.check_update,a.startup=o.startup}}}).catch(t=>{r.error(t),console.error("getGlobalConfig",t)})},w=()=>{d.value=!0,b.addOrUpdateGlobalConfig({data:a}).then(t=>{const e=t.data;e.code!=0?r.warning(e.msg||"保存失败"):(r.success(e.msg||"保存成功"),q(a.dark_mode),a.check_update?(m.addCallback("check_update",D),m.start(1e3*60*60*6)):m.removeCallback("check_update"),p()),d.value=!1}).catch(t=>{r.error(t),d.value=!1})};return B(()=>{p()}),(t,e)=>{const s=T,o=O,C=G,E=M,V=L,y=N;return _(),f(V,null,{header:l(()=>[...e[3]||(e[3]=[g("div",{class:"card-header"},[g("span",null,"应用设置")],-1)])]),default:l(()=>[n(E,{model:a,ref_key:"refForm",ref:h,"label-width":"auto"},{default:l(()=>[n(o,{label:"黑暗模式",prop:"dark_mode"},{default:l(()=>[n(s,{modelValue:a.dark_mode,"onUpdate:modelValue":e[0]||(e[0]=c=>a.dark_mode=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),n(o,{label:"自动检查更新",prop:"check_update"},{default:l(()=>[n(s,{modelValue:a.check_update,"onUpdate:modelValue":e[1]||(e[1]=c=>a.check_update=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),n(o,null,{default:l(()=>[S((_(),f(C,{type:"primary",onClick:e[2]||(e[2]=c=>w())},{default:l(()=>[...e[4]||(e[4]=[I("保存",-1)])]),_:1})),[[y,d.value]])]),_:1})]),_:1},8,["model"])]),_:1})}}});export{R as default};
