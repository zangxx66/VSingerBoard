import{d as y,r as p,u as B,bI as D,bJ as F,b as I,o as U,f,h as _,w as n,l as s,bC as G,B as i,aD as k,bK as v,p as L,G as M,x as N,aT as O,D as h,j as g,E as r,bL as j,aV as q}from"./index-DpnPDkPA.js";/* empty css                   */import{E as J}from"./el-card-BsRx5XEv.js";import{E as K,a as $}from"./el-form-item-aT5iZVfD.js";/* empty css                  */import"./Settings-Bq9ruAbq.js";import"./toNumber-DNF8ov4a.js";const Y=y({__name:"appSettingTab",setup(z){const b=p(),d=p(!1),m=B(),V=D(),w=F(),t=I({id:0,dark_mode:!1,check_update:!1,startup:!1}),u=()=>{g.getGlobalConfig({}).then(a=>{const e=a.data;if(e.code!=0)r.warning(e.msg||"获取失败");else{const l=e.data.data;if(l){const o=l;t.id=o.id,t.dark_mode=o.dark_mode,t.check_update=o.check_update,t.startup=o.startup}}}).catch(a=>{r.error(a),console.error("getGlobalConfig",a)})},C=()=>{d.value=!0,g.addOrUpdateGlobalConfig({data:t}).then(a=>{const e=a.data;if(e.code!=0)r.warning(e.msg||"保存失败");else{r.success(e.msg||"保存成功"),j(t.dark_mode),w.setDarkTheme(t.id,t.dark_mode);const l=t.dark_mode?"mac dark":"mac";V.setTheme(l),t.check_update?m.addInterval("check_update",q,1e3*60*60*6):m.removeInterval("check_update"),u()}d.value=!1}).catch(a=>{r.error(a),d.value=!1})};return U(()=>{u()}),(a,e)=>{const l=G,o=$,x=M,E=K,S=J,T=O;return _(),f(S,null,{header:n(()=>[...e[3]||(e[3]=[h("div",{class:"card-header"},[h("span",null,"应用设置")],-1)])]),default:n(()=>[s(E,{model:t,ref_key:"refForm",ref:b,"label-width":"auto"},{default:n(()=>[s(o,{label:"黑暗模式",prop:"dark_mode"},{default:n(()=>[s(l,{modelValue:t.dark_mode,"onUpdate:modelValue":e[0]||(e[0]=c=>t.dark_mode=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),s(o,{label:"自动检查更新",prop:"check_update"},{default:n(()=>[s(l,{modelValue:t.check_update,"onUpdate:modelValue":e[1]||(e[1]=c=>t.check_update=c),"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-icon":i(v),"inactive-icon":i(k)},null,8,["modelValue","active-icon","inactive-icon"])]),_:1}),s(o,{label:"开机启动",prop:"startup"},{default:n(()=>[s(l,{"model-value":t.startup,"inline-prompt":"",style:{"--el-switch-off-color":"#ff4949"},"active-text":"开",inactiveText:"关"},null,8,["model-value"])]),_:1}),s(o,null,{default:n(()=>[L((_(),f(x,{type:"primary",onClick:e[2]||(e[2]=c=>C())},{default:n(()=>[...e[4]||(e[4]=[N("保存",-1)])]),_:1})),[[T,d.value]])]),_:1})]),_:1},8,["model"])]),_:1})}}});export{Y as default};
