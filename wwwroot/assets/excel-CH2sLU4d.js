import{e}from"./vendor-exceljs-C-8i3j8b.js";const t=async(t,o,n)=>{const r=new e.Workbook,s=r.addWorksheet("Sheet1");s.columns=t,s.addRows(o);const c=await r.xlsx.writeBuffer(),a=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),i=window.URL.createObjectURL(a),d=document.createElement("a");d.href=i,d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(i)},o=async(t,o)=>{if(!o)return[];const n=new e.Workbook;try{const e=(await n.xlsx.load(o)).getWorksheet(1);if(!e)return[];const r=[];let s=[];return e.eachRow((e,o)=>{const n=e.values;if(1===o)return void(s=n.slice(1).map(e=>e?String(e):""));const c={};n.slice(1).forEach((e,o)=>{const n=s[o];if(n){const o=t.find(e=>e.header===n);if(o&&o.key){const t=((e,t)=>{if(!e||!t)return e;switch(t){case"string":return String(e);case"number":const t=Number(e);return isNaN(t)?e:t;case"boolean":if("boolean"==typeof e)return e;const o=String(e).toLowerCase();return"true"===o||"1"===o||"是"===o||"false"!==o&&"0"!==o&&"否"!==o&&Boolean(e);default:return e}})(e,o.type);c[o.key]=t}}}),r.push(c)}),r}catch(r){throw r}};export{t as e,o as i};
